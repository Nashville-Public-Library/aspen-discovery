## Aspen Discovery Updates

### Account Updates
- Enable Messaging Settings for Sierra and allow patrons to set their own notice preference. (DIS-884) (*KP*)
- Match the expiration date display format of linked library cards with the primary library card. (DIS-1159) (*LS*)

### Administration Updates
- Removed the 15-minute interval restriction when updating Library Hours under the Locations settings; any time can be chosen. (DIS-1137) (*LS*)
- Documentation links now automatically open in new tabs, allowing administrators to reference help without losing their current configuration work. (DIS-169) (*LS*)
- Object History Improvements: (DIS-1058) (*LS*)
  - Improved change tracking for child objects so edits to settings now capture individual field changes such as renames, toggles, and date edits.
  - Added deletion tracking so removing a child object creates a clear history entry showing which item was deleted.
  - Made history entries display human-readable names instead of raw IDs to make changes easier to understand.
  - Adjusted history logging to only record updates when related items are actually added, removed, or reordered, thus reducing unnecessary entries.
  - Fixed Library and Location objects so missing `cloudLibraryScope` values are handled correctly without converting blanks to "none" and creating unnecessary history entries.
- Object comparisons now show human-readable names instead of numeric IDs for better administrator experience. (DIS-1059) (*LS*)
  - Holidays display as "Holiday Name (Date)" format for clear identification.
  - Themes show actual theme names instead of numeric references.
  - Records to Include display location names for easier identification.
  - Side Load Scopes show scope names rather than cryptic IDs.
  - Sublocations display their descriptive names.
  - HTML content fields are now stripped of tags and normalized for accurate text-based comparisons.
  - Added "Return to List" button to the Compare Objects page.
- The "Compare" button is now disabled until at least two objects have been selected for comparison; an error continues to display if more than two objects are selected. (DIS-1059) (*LS*)
- Object Restorations: (DIS-1076) (*LS*)
  - The following objects can be restored after their deletion:
    - User Lists
      - Patrons may choose "Opt Out of Soft Deletion" to permanently delete them immediately.
    - Basic Pages 
    - Custom Pages (Portal Pages)
    - Custom Forms 
    - Web Resource Pages 
    - Web Resources 
    - Image Uploads (hard-deleting removes the file from the server)
    - File Uploads (hard-deleting removes the file from the server)
    - Placards
  - A daily process permanently deletes any items that have been soft-deleted for more than 30 days.
  - A new permission, "Administer Object Restoration," is required to access the Restore Deleted Objects page.

### API Documentation Updates
- Document getListTitles from ListAPI in the API docs (DIS-1123) (*WS*)
- Added Open API documentation for the User API, Event API, and Work API. (*KK*)

### Aspen LiDA
- Added Notification Testing Tool to send test notifications to a device and view the response from the Expo Notification Service. (DIS-84) (DIS-1008) (*KK*)

### API Updates
- Provide additional information to LiDA to properly handle Local ILL request actions for volumes. (DIS-1115) (*MDN*)
- Allow Local ILL request emails to be submitted. (DIS-1115) (*MDN*)
- Added filter parameter to getPatronReadingHistory to User API to handle searching reading history in LiDA. (DIS-1118) (*KK*)
- Fixed error in List API when retrieving user list data for non-LiDA applications. (DIS-1148) (*LS*)
- Improved error handling when updating a Browse Category with the same settings; now shows a clear message explaining the update isn't allowed. (DIS-1095) (*LS*)
- Sort options are now shown or hidden based on source type to prevent selecting unsupported sorting methods. (DIS-1095) (*LS*)
- Fixed an issue where libraries could not be chosen in community Aspen LiDA because the API response contained bad data. (DIS-1206) (*LS*)
- Fix warning message in searchLite and getGroupedWork with certain data when a variation exists with an invalid manifestation for the current instance. (DIS-1207) (*MDN*)

### Browse Category Updates
- Fixed an issue where browse categories created through the admin interface did not save the creator's user ID. (DIS-1135) (*LS*)

### Circulation Reports Updates
- Nashville-only: Added a report to display school librarians information (DIS-1171) (*JStaub*)
- Made the text of printable student reports translatable. (DIS-1175) (*JStaub*)

### Cloud Library Updates
- Add deletion process for expired Cloud Library records during Incremental updates. (DIS-1099) (*YL*)
- Refactor deletion logic for full update and incremental updates. (DIS-1099) (*YL*)

### Collection Spotlight Updates
- Refined permission logic to no longer incorrectly check users with "Administer All Collection Spotlights" for a home library when creating a new Collection Spotlight. (DIS-1095) (*LS*)
- Sort options are now shown or hidden based on source type to prevent selecting unsupported sorting methods. (DIS-1095) (*LS*)

### Community Engagement Updates
- Correct error checking if progress has been recorded previously for Rating Milestones. (DIS-1190) (*MDN*)
- Fixed an issue where milestone progress would not update when Polaris holds were made. (DIS-1166) (*LS*)
- Prevent an error from being logged when a reward with no image is saved. (DIS-1176) (*AB*)
- Remove unneeded check for display of campaign leaderboard. (DIS-1173) (*AB*)
- Fixed campaigns with no stat or end date displaying for linked users. (DIS-1169) (*AB*)
- Prevented the addition of progress data titles to milestones that are complete and not set to track progress beyond 100%. (DIS-1143) (*AB*)
- Update the modal that displays when enrolling in a campaign to include a link to contact information and to use a .tpl file. (DIS-701) (*AB*)
- Add the ability for admin to enroll users in campaigns. (DIS-470) (*AB*)
- Add the option of using a search bar rather than a dropdown to search users. (DIS-470) (*AB*)
- Fix undefined array key in linked user campaigns table (DIS-1136) (*AB*)
- Add the ability for libraries to choose whether to display digital reward images at all times or to show a placeholder until the reward has been obtained (DIS-1129) (*AB*)
- Add the ability for libraries to upload a placholder image of their choosing (DIS-1129) (*AB*)
- Added the option of adding extra credit activities to campaigns. These activities have goals and rewards but do not count towards the campaign completion. (DIS-655) (*AB*)
- Add the option to highlight campaigns that are open to enrollment within the campaign highlights banner. (DIS-1126) (*AB*)
- Add the title of the item contributing to milestone progress to the staff view. (DIS-1144) (*AB*)
- Add the ability to restrict campaigns by location. (DIS-1120) (*AB*)
- Added toast notifications to Community Engagement campaign milestones progress (DIS-1019) (*PA*)

### Cover Image Updates
- Fixed expired Library Market and Communico events not displaying covers in default list covers. (DIS-1112) (*LS*)
- Improved support for displaying title and author text on default cover images for languages using non-Latin scripts. (DIS-1162) (*LS*)
  - Supported scripts now include:
    - Arabic
    - Armenian
    - Cyrillic
    - Japanese
    - Han
    - Hangul
    - Devanagari
    - Hebrew
    - Telugu
    - Thai
    - Georgian
    - Latin
- Updated text-wrapping logic to better handle the character structure of various scripts, improving visual presentation on default covers. (DIS-1162) (*LS*)

### Cron Updates
- Allow PHP-based cron processes to be triggered from the admin interface. (DIS-1192) (*MDN*)
- Include logging for PHP-based cron processes to be displayed from the admin interface. (DIS-1192) (*MDN*)
  - Supported cron processes include:
    - Cleanup Shared Sessions
    - Create Sitemaps
    - Dismiss Year-in-Review Messages
    - Fetch ILS Messages
    - Fetch Notification Receipts
    - Generate Material Request Hold Candidates
    - Load Initial Reading History
    - Send Campaign Emails
    - Send Campaign Ending Emails
    - Send ILS Messages
    - Send LiDA Notifications
    - Talpa Recalculation
    - Talpa Works
    - Update Community Translations
    - Update Suggesters
- Do not allow cron entries to be expanded if they have no sub processes. (DIS-1192) (*MDN*)
- Allow cron entries to be filtered by searched by name, to only show entries with errors, and allow page size to be set. (DIS-1192) (*MDN*)
- Added Purge Soft-Deleted Objects and Update NYT Lists as supported cron processes to be run from the admin interface. (DIS-1204) (*LS*)
- Added "Log Frequent Cron Jobs" to System Variables and defaulted it to be disabled to prevent frequently run cron jobs from cluttering the cron logs. (DIS-1204) (*LS*)

<div markdown="1" class="settings">

#### New Permissions
- Manually Run Cron Processes - Allows the user to manually start cron processes.

#### New Settings
- System Administration > Manually Run Cron
- System Administration > System Variables > Log Frequent Cron Jobs

</div>

### Deep Linking Updates
- Allow linking to the Aspen Materials Request forms from LiDA. (DIS-1115) (*MDN*)

### E-Commerce Updates
- Fixed an issue where NCR payments would be marked as cancelled if the transaction/order ID ended in zero. (DIS-1119) (*LS*)

### Email Updates
- Add token in email templates to include the URL for messaging settings. (DIS-884) (*KP*)

### Events Updates
- Recurring native events now maintain correct display times across Daylight Saving Time transitions instead of appearing one hour off after DST changes. (DIS-1158) (*LS*)
- Fixed an issue where Browse Categories and Collection Spotlights created from Event searches did not retain the "Event Date" sort and defaulted to "Best Match". (DIS-1095) (*LS*)

### Evergreen Updates
- Expiration date on Library Card page now correctly shows the patron's date when masquerading, not the staff account's. (DIS-1088) (*LS*)

### Holds Updates
- Implemented new "Maximum Hold Cancellation Date" setting under Library System to restrict future hold cancellations. (DIS-1057) (*LS*)
  - Patrons cannot place holds with a cancellation date beyond the configured maximum.
  - If "Show Hold Cancellation Date" is disabled, related settings are hidden to reduce confusion.
  - Updated names and descriptions for all related settings to better reflect their behavior.
- Added the option to sort Pending Holds by "Hold Cancellation Date". (DIS-1057) (*LS*)
- Resolved an issue where multiple volume holds could be placed by repeatedly clicking the button to place holds in the loading modal. (DIS-1121) (*LS*)
- Added spinner icons to place hold buttons across Aspen to indicate modal loading of place-hold forms or hold submission in progress. (DIS-1121) (*LS*)
- The volume holds form now hides suppressed volumes that would previously appear as selectable options but lead to errors when placing a hold. (DIS-1152) (*LS*)
- Validate patron's actual preferred pickup location instead of defaulting to home location when "Remember Pickup Location" preference is enabled. (DIS-1172) (*LS*)
- Added messages on hold prompts to provide context about why manual pickup location selection is needed for some cases. (DIS-1172) (*LS*)
- Refined pickup location display order so that search results availability now correctly prioritizes pickup locations in the logical sequence: preferred pickup location, alternate pickup location 1, alternate pickup location 2, home library, and so on. (DIS-1027) (*LS*)
- Resolved an issue where the patron's home library would always be the top result when selecting at what location to place a hold. (DIS-1027) (*LS*)

<div markdown="1" class="settings">

#### New Settings
- Library System > ILS/Account Integration > Holds > Maximum Hold Cancellation Date

</div>

### Hoopla Updates
- Allow Hoopla records to display with 'Access Online' button if in Library Systems, Hoopla Library ID set to 0. (DIS-1178) (*YL*)
- Add error handling for placing holds for Hoopla Flex titles.  (DIS-1180) (*YL*)

### Indexing Updates
- Add Video Enabled Book Format based on 300a containing "video-enabled book". (DIS-1183) (*MDN*)
- Add handling of 810, 811, 896, 897, 898, and 899 fields for series data. (DIS-1184) (*MDN*)
- Added debug messages in scope inclusion rules for the Diagnostics modal to now provide explanations when items are excluded from library scopes. (DIS-1089) (*LS*)
- Check inclusion rule for null column values. (DIS-1194) (*MDN*)

### Local ILL Updates
- When placing holds on titles that require a local ILL request for a volume which cannot be filled by the underlying ILS, perform one of the following actions depending on library configuration. (DIS-1115) (*MDN*)
  - Direct the user to the Aspen materials request system. 
  - Direct the user to the external request URL
  - Prompt the user for information about their request and email the library. 
  - Show a message to contact the library to place the request (previous behavior).

### Koha Updates
- Added additional version checks around the Koha preferred name feature to prevent compatibility issues on instances running versions prior to 24.11. (DIS-1149) (*LS*)
- Added consideration of "On Hold Shelf" item status for available records when "Prioritize Available Records for Title Selection" is enabled. (DIS-1132) (*LS*)
- Fixed an issue where the "On Order" record's title would still be chosen for display in the grouped work if it was processed first when "Prioritize Available Records for Title Selection" is enabled. (DIS-1132) (*LS*)
- Added the option to automatically update contact information during indexing. (DIS-1137) (*LS*)
  - Fixed an issue where new Locations could not be imported from Koha to Aspen.
- Renamed the "Automatically Update with Closures from the ILS" to "Automatically Update with Library Hours and Closures from the ILS" to reflect its additional behavior of automatically updating Library Hours during indexing. (DIS-1137) (*LS*)
- Added "Allow Material Requests Branch Choice" setting for the ILS Request System, allowing patrons to select which branch should receive their materials request instead of defaulting to their home branch. (DIS-1153) (*LS*)
- Patrons who have not performed any patron operations (e.g., checking out a record) within 23 hours will not have their reading histories updated during the nightly run. (DIS-1211) (*LS*)

<div markdown="1" class="settings">

#### New Settings
- Primary Configuration > Library System > Materials Request > Allow Material Requests Branch Choice
- Primary Configuration > Locations > Automatically Update Contact Information from the ILS

</div>

### Materials Request Updates
- Optionally, send staff an email after a new Materials Request is created. (DIS-1113) (*MDN*)
- Add a request source to differentiate between requests placed via Aspen Materials Request and those placed via Local ILL. (DIS-1115) (*MDN*)
- Improved usage tracking for Materials Requests to include status changes made by staff in all admin interfaces and via the API. (DIS-1083) (*LS*)
- Resolved an issue where placing holds on OverDrive titles through the Requests Needing Holds interface would fail when record IDs contained source and/or format prefixes. (DIS-1151) (*LS*)
- Fixed a library scoping issue that allowed staff to see Requests Needing Holds from other Library Systems. (DIS-1151) (*LS*)
- Allow Local Administrators to be assigned to a request within the Update Request form. (DIS-1014) (*MDN*)

### Open Archives Updates
- Fixed an issue where dates shown in Open Archives collections would differ from the dates displayed on external archive websites. (DIS-1063) (*LS*)
- Added detailed progress tracking and log entries for Open Archives indexing. (DIS-1063) (*LS*)

### OverDrive Updates
-  Limit OverDrive hold suspension to 365 days max. If no date is selected or if the selected date is more than 365 days in the future, the suspension will automatically default to 365 days.(DIS-1086) (*YL*)

### Performance Updates
- Optimize Loading Lists of libraries and Indexing Profiles. (DIS-1182) (*MDN*)

### Reading History Updates
- Increased the connection and read timeouts during nightly reading history updates to prevent occasional errors for patron accounts. (DIS-1200) (*LS*)
- Reduced the Java thread count for nightly reading history updates to slow down the number of API calls within intervals of time. (DIS-1211) (*LS*)

### Searching Updates
- Search suggestions now correctly exclude records that are outside the current library or location scope, preventing titles not available in the searched catalog from appearing. (DIS-1167) (*LS*, *YL*)
- Added language scoping to search suggestions when a user has selected a non-English language and `searchPreferenceLanguage` is enabled, ensuring suggestions match the chosen language like the catalog results already do. (DIS-1167) (*LS*, *YL*)
- Added top facets to Author search results pages to maintain consistency with regular catalog search results. (DIS-1040) (*LS*)

### Self Registration Updates
- Validate formats for email addresses and ten digit phone numbers during self registration. (DIS-884) (*KP*)
- For Sierra only, allow specific PType, PCodes, and account expiration to be automatically set based on patron city, county, or state. (DIS-884) (*KP*)
- For Sierra only, allow the user to choose a notice preference during self registration. (DIS-884) (*KP*)
- For Sierra only, add an option to use the Sierra patron record ID as a barcode instead of assigning one during self registration. (DIS-884) (*KP*)
- For Sierra only, add an option to check for duplicate patrons during registration and disallow if a patron already exists with the same name and birthdate.  (DIS-884) (*KP*)
- For Sierra only, log self registrations and display them in Review Library Registrations so that they can be edited, approved, or deleted. (DIS-884) (*KP*)
- Add an option to Sierra Self Reg form to not set the Agency field because using it when not enabled in Sierra was causing self registration to fail. (DIS-884) (*KP*)
- Add option to have the user agree to the Terms of Service before showing the Self Registration form. (DIS-884) (*KP*)
<div markdown="1" class="settings">

#### New Permissions
- Manage Self Registration Municipalities - Allows the user to view and edit the Municipality Settings on Sierra Self Registration Forms.
- Review Self Registrations for All Libraries - Allows the user to view, edit, approve, and delete self registrations in Review Library Registrations for all libraries.
- Review Self Registrations for Home Library Only - Allows the user to view, edit, approve, and delete self registrations in Review Library Registrations for their home library.

#### New Settings
- ILS Integration > Review Library Registrations
- ILS Integration > Self Registration Forms (Sierra) > Use Patron ID as Barcode
- ILS Integration > Self Registration Forms (Sierra) > Turn Off Duplicate Checking
- ILS Integration > Self Registration Forms (Sierra) > Use Patron Agency
- ILS Integration > Self Registration Forms (Sierra) > Municipality Settings
- ILS Integration > Self Registration TOS > Show TOS First
- Library Systems > ILS/Account Integration > Self Registration > Log Self Registrations

</div>

### Series Updates
- Properly index series with no audiences applied. (DIS-1185) (*MDN*)
- Do not index series which have no members. (DIS-1209) (*MDN*)
- Resolved an issue where Hidden Series with parentheses would not be hidden. (DIS-1139) (*LS*)
- Fixed Hidden Series functionality to properly filter NoveList series data from grouped work displays. (DIS-1139) (*LS*)

### Side Loads Updates
- Fixed an issue where the "Delete" button in Side Load >>> MARC Files did not work for filenames that include an apostrophe. (DIS-1066) (*LS*)
- As a part of standardization, a confirmation modal will now display when deleting side-loaded MARC files. (DIS-1066) (*LS*)
- Added "Comic" as an option under "Specified Format Category" to allow side loads to group under the category "comic". (DIS-1127) (*LS*)

### Symphony Updates
- Allow checking out titles using Scan and Go to patrons that have fines or fees, but the total fines have not reached the bill threshold for their patron type. (DIS-1117)

### User List Updates
- Correctly set the list entry title when adding Aspen Native Events to a list. (DIS-1150) (*MDN*)
- Updated sorting by title and author to use left joins on relevant tables for list entries (DIS-1091) (*KL*)
- Fixed sorting issues when creating from list searches: "Date Added" and "Date Updated" are now respected. (DIS-1095) (*LS*)
  - Introduced a new source type, "Public List Search," to better support sorting and behavior from public list searches.

### While You Wait / You Might Also Like Updates
-  Add scoping options for While You Wait and You Might Also Like to optionally limit results by owning library and format (DIS-995) (*KL*)

<div markdown="1" class="settings">

#### New Settings
- Library Systems > ILS/Account Integration > Show You Might Also Like

</div>

### Other Updates
- Allow manually grouping records from the Author page. (DIS-1134) (*MDN*)
- Prevent crawlers from indexing Grouped Works with additional parameters (i.e., activeFormat and searchSource) (DIS-995) (*KL*)
- MarcRecordDriver doing preliminary check if the record would pull up the invalidRecord.tpl template when trying to display and returns an empty string for its linkUrl if so to avoid pointing Patrons to links they cannot load. (DIS-948) (*IT*)
- Added the ungrouped status indicator for the Staff Views of Hoopla, Axis360, Palace Project, and CloudLibrary records. (DIS-1080) (*LS*)
- Added proper auto-close timer cleanup to prevent timer conflicts between sequential modals. (DIS-1090) (*LS*)
- Improved auto-close timer logic for modals to support both boolean (3-second default) and numeric (custom milliseconds) timeout values. (DIS-1090) (*LS*)
- Removed the misleading "Logging you in now. Please wait." alert when a login fails. (DIS-1090) (*LS*)
- Fixed an issue where sorting on the Host Information page did not work. (DIS-1097) (*LS*)
- New rows in admin settings now stay in the correct order on first save when you drag and drop them. (DIS-1111) (*LS*)
- Fixed PHP autoloader failing when cron scripts are run from subdirectories, resolving "Failed opening required" errors, such as when running `loadInitialReadingHistory.php`. (DIS-1156) (*LS*)
- Fixed database column defaults for Library and Location record inclusion settings to match PHP class defaults, ensuring consistent behavior when importing from ILSs: `includeHoldableOnly` defaults to disabled, `includeItemsOnOrder` and `includeEContent` default to enabled. (DIS-1170) (*LS*)
- Fixed an issue where the page would continuously scroll to the top, preventing normal user scrolling. (DIS-1187) (*LS*)
- "Staff View" and "Reviews from GoodReads" accordions now loads properly when set to open automatically in Grouped Work Display settings. (DIS-131) (*LS*)
- Removed unused `Springshare/moredetails-accordion.tpl`. (DIS-131) (*LS*)
- Fixed an issue where new Administrators could not be added for SSO accounts. (DIS-1188) (*LS*)
- Fixed an issue where PHP warnings would spam `error.log` due to an incorrect use of `trim()`. (DIS-1162) (*LS*)
- Corrected DataObject framework bug where zero values in database queries were incorrectly excluded from count operations due to PHP's loose equality comparison, affecting any interface using `count()` with zero-value conditions. (DIS-1151) (*LS*)
- Modify the tooltips of 'Last Update of All Records' in Axis360(Boundless), CloudLibrary, Hoopla, OverDrive, Palace Project. (DIS-1189) (*YL*)
- Tidy up the default bad bots list. (DIS-1141) (*JStaub*)
- Add and remove bad bots from the default list. (DIS-1142) (*JStaub*)
- Nashville-only: Send staff email when non-resident update fails following out-of-county fee payment. (DIS-1125) (*JStaub*)
- Edit buttons on compare and history pages can be controlled by a new utility method: `ObjectEditor::showEditButtonsInCompareAndHistoryViews()`. (DIS-1076) (*LS*)
- All portal row, portal cell, and object deletions on their respective pages now use the standard confirmation modal. (DIS-1076) (*LS*)
- Minor updates and bug fix for Talpa Works crons. (DIS-1195) (*LP*)
- Fixed foreign key constraint errors during site creation. (DIS-1198) (*LS*, *MDN*)
- Fixed Apache2 restart warning in rebuild_gd_raqm.sh by adding a check to only restart if Apache2 is already running, improved its PHP source directory detection, and prevented script failures due to apt repository errors. (DIS-1198) (*LS*)
- Fixed an issue where LiDA would receive an invalid response when attempting to use the “Forgot Barcode or Username” feature because Twilio’s Product APIs only return JSON responses, but Aspen was incorrectly expecting XML responses. (DIS-1206) (*LS*)
- Fixed an issue where Symphony self registrations in LiDA would fail with a long PHP warning message. (DIS-1206) (*LS*)
- Allowed 'Q' in the second position of release notes naming. (DIS-1212) (*LS*)

## This release includes code contributions from
### ByWater Solutions
- Leo Stoyanov (LS)
- Yanjun Li (YL)
- Imani Thomas (IT)

### Cleveland Public Library
- Will Skora (WS)

### Grove For Libraries
- Mark Noble (MDN)
- Kirstien Kroeger (KK)
- Katherine Perdue (KP)
- Kodi Lein (KL)

### LibraryThing
- Lauren Przywara (LP)

### Nashville Public Library
- James Staub (JStaub)

### Open Fifth
- Alexander Blanchard (AB)
- Pedro Amorim (PA)

## Special Testing thanks to
- Aaron Skog (SWAN)
- Desiree Saunders (WYLD)
- Jordan Fields (Grove)
- Kirstien Kroeger (Grove)
- Leo Stoyanov (ByWater)
- Lucas McKeever (SWAN)
- Mark Noble (Grove)
- Myranda Fuentes (Grove)
- Tara Wood (SWAN)

## Special Documentation thanks to
- Tricia Andrews (Metropolitan Library System)
- Myranda Fuentes (Grove)
- Jeff Godin (Traverse Area District Library)
- Will Skora (Cleveland Public Library)

## This release includes sponsored developments from
- CLEVNET Library Cooperation
- Gail Borden Public Library
- Milwaukee County Federated Library System (MCFLS)
- SWAN Library Network
- Wyoming State Library (WYLD)
